<div class="bg-white shadow rounded-lg p-6 h-full flex flex-col">
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
    <h2 class="text-xl md:text-2xl font-bold text-gray-800">Knowledgebase Editor</h2>
    <div class="flex items-center space-x-4 w-full md:w-auto justify-end">
      <span *ngIf="lastSaved" class="text-sm text-green-600">
        Saved at {{ lastSaved | date:'mediumTime' }}
      </span>
      <button (click)="togglePreview()"
        class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors text-sm md:text-base">
        {{ isPreviewMode ? 'Edit' : 'Preview' }}
      </button>
      <button (click)="save()"
        class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-sm md:text-base">
        Save
      </button>
    </div>
  </div>

  <div class="flex-1 border rounded-lg overflow-hidden flex flex-col">
    <!-- Toolbar -->
    <div *ngIf="!isPreviewMode" class="bg-gray-50 border-b p-2 flex space-x-2 overflow-x-auto">
      <button (click)="insertText('**', '**')" class="p-2 hover:bg-gray-200 rounded" title="Bold">
        <span class="font-bold">B</span>
      </button>
      <button (click)="insertText('*', '*')" class="p-2 hover:bg-gray-200 rounded" title="Italic">
        <span class="italic">I</span>
      </button>
      <button (click)="insertText('# ', '')" class="p-2 hover:bg-gray-200 rounded" title="Heading">
        <span class="font-bold">H</span>
      </button>
      <button (click)="insertText('- ', '')" class="p-2 hover:bg-gray-200 rounded" title="List">
        <span>â€¢</span>
      </button>
      <button (click)="insertText('[', '](url)')" class="p-2 hover:bg-gray-200 rounded" title="Link">
        <span class="underline">Link</span>
      </button>
    </div>

    <textarea *ngIf="!isPreviewMode"
      [(ngModel)]="content"
      class="flex-1 w-full p-4 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"
      placeholder="Type your markdown here..."></textarea>
    
    <div *ngIf="isPreviewMode" class="flex-1 w-full p-4 overflow-auto prose max-w-none bg-white">
      <markdown [data]="content"></markdown>
    </div>
  </div>
</div>
